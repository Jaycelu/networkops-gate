# 系统架构设计

## 1. 整体架构概览

本产品分为两个主要组成部分：

1. **Web官网**：基于HTML/CSS/JavaScript构建的营销官网，提供产品介绍、用户注册登录、账单管理、应用下载等功能
2. **移动桌面端应用**：基于AI大模型驱动的专业工具，支持Windows、macOS、Linux平台，帮助用户快速完成网络架构设计、设备配置及管理

## 2. Web官网架构

### 2.1 技术栈
- **前端**：HTML5 + CSS3 + JavaScript (ES6+)
- **UI框架**：Tailwind CSS + Iconify图标库
- **交互功能**：原生JavaScript实现注册登录、账单管理等
- **部署**：阿里云ECS + CDN静态资源加速

### 2.2 架构图
```
用户浏览器
    ↓
[Web服务器/Nginx]
    ↓
[静态文件: HTML/CSS/JS]
```

### 2.3 目录结构
```
website/
├── index.html          # 首页
├── css/
│   └── style.css       # 样式文件
├── js/
│   ├── main.js         # 主要交互逻辑
│   ├── auth.js         # 认证相关功能
│   └── billing.js      # 账单管理功能
├── assets/
│   ├── images/         # 图片资源
│   └── icons/          # 图标资源
└── downloads/          # 应用下载文件
```

## 3. 移动桌面端应用架构

### 3.1 技术栈
- **前端**：
  - **跨平台框架**：Electron框架开发，支持Windows、macOS、Linux
  - **UI界面**：采用现代化的桌面应用设计，与原型图保持一致
- **后端**：
  - API服务基于Flask框架，处理用户请求。
  - AI模块集成大模型API代理（如aihubmix），支持动态切换大模型。
  - 规则校验模块：独立服务，基于Python开发，校验AI输出。
  - 自动化脚本引擎基于Python Paramiko，用于设备交互（如SSH配置推送）。
- **数据存储**：
  - 本地SQLite数据库存储用户信息、设计方案、配置历史
  - 云端同步支持（可选）
- **设备交互**：支持SSH/串口通信。
- **部署**：通过Electron打包为各平台安装包进行分发

### 3.2 架构图
```
用户界面 (Electron前端)
    ↓
[本地API服务 (Flask)]
    ↓
├── AI模块 (大模型API代理)
├── 规则校验模块 (Python)
├── 自动化脚本引擎 (Paramiko)
└── 本地数据库 (SQLite)
```

### 3.3 目录结构
```
desktop-app/
├── main.js             # Electron主进程
├── preload.js          # 预加载脚本
├── index.html          # 主界面HTML
├── renderer/           # 渲染进程
│   ├── js/             # 前端JavaScript
│   ├── css/            # 样式文件
│   └── assets/         # 静态资源
├── backend/            # 后端服务
│   ├── api/            # Flask API服务
│   ├── ai/             # AI模块
│   ├── validator/      # 规则校验模块
│   └── automation/     # 自动化脚本引擎
├── database/           # 数据库相关
│   └── schema.sql      # 数据库结构
└── config/             # 配置文件
```

## 4. 数据流设计

### 4.1 Web官网数据流
1. 用户访问官网页面
2. 浏览器加载静态资源
3. 用户进行注册/登录操作
4. 前端通过AJAX与后端API通信
5. 后端处理请求并返回结果
6. 前端更新界面显示

### 4.2 桌面应用数据流
1. 用户启动桌面应用
2. Electron加载主界面
3. 用户进行操作（设计网络、生成配置等）
4. 前端通过IPC与后端服务通信
5. 后端服务调用AI模块或规则校验模块
6. 处理结果返回给前端显示
7. 数据存储到本地数据库

## 5. 安全设计

### 5.1 Web官网安全
- 用户密码加密存储
- HTTPS安全传输
- XSS和CSRF防护

### 5.2 桌面应用安全
- 用户输入的设备凭据（如SSH用户名、密码）及API密钥需加密存储和传输
- 配置操作需用户确认，避免误操作

## 6. 部署架构

### 6.1 Web官网部署
- **基础设施**：
  - **ECS（弹性计算服务）**：运行静态网站文件
  - **CDN**：阿里云CDN加速静态资源分发
  - **OSS**：存储应用安装包和用户上传文件
- **域名与SSL**：绑定域名并配置HTTPS证书

### 6.2 桌面应用分发
- **应用打包**：使用Electron Builder生成各平台安装包
- **分发渠道**：
  - 官网直接下载
  - 应用商店（可选）
  - 企业内部分发
- **版本管理**：提供版本更新机制和下载统计